---
import Layout from "@/layouts/Layout.astro";
import Container from "@/components/Container.astro";
import Summary from "@/components/resume/SummaryExperience.astro";
import { getExperiences } from "@/services/experience";
import Markdown from "@/components/Markdown.astro";

const experiences = await getExperiences();
---

<Layout title="Experience">
  <Container>
    <div class="flex flex-col gap-4">
      <!-- <div class="ml-4">
        <a
          href="/resume"
          rel="noopener"
          class="inline-block px-3 py-1 rounded border text-sm hover:opacity-90 bg-white/90 dark:bg-gray-800/60"
          >View as Resume</a
        >
      </div> -->
      <div class="flex items-center justify-between gap-4">
        <Summary />
        <!-- <div class="ml-4">
          <a
            href="/resume"
            target="_blank"
            rel="noopener"
            class="inline-block px-3 py-1 rounded border text-sm hover:opacity-90 bg-white/90 dark:bg-gray-800/60"
            >View as Resume</a
          >
        </div> -->
      </div>

      <div class="mt-8 flex flex-col gap-8">
        {
          experiences
            .sort(
              (a, b) =>
                new Date(b.start).getTime() - new Date(a.start).getTime(),
            )
            .map((exp) => (
              <section class="pt-4" id={`exp-${exp.id}`}>
                <div class="flex flex-col gap-2">
                  <div class="flex items-baseline justify-between gap-4">
                    <div>
                      <h3 class="text-xl font-semibold">
                        {exp.title} — {exp.company}
                      </h3>
                      {/* <div class="text-sm opacity-70">{exp.location} • {new Date(exp.start).toLocaleDateString()} {exp.end ? `— ${new Date(exp.end).toLocaleDateString()}` : '— Present'}</div> */}
                    </div>
                  </div>

                  {exp.overview && <p class="pt-2">{exp.overview}</p>}

                  {exp.details && (
                    <div class="pt-2">
                      <Markdown content={exp.details} />
                    </div>
                  )}
                </div>
              </section>
            ))
        }
      </div>
    </div>
  </Container>
</Layout>
